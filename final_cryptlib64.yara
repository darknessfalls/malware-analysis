rule cryptlib64 {
    
    meta: 
        last_updated = "2024-01-08"
        author = "Jarrett Sams"
        description = "My Yara rule for the PMAT final (cryptlib64.exe)"

    strings:
        // Fill out identifying strings and other criteria
        $namespace = "System.Security.Cryptography"
        $embed_files_bytecode = { 72 3? ?? ?? ?? }
        $embed_reg_key_bytecode = { 72 83 ?? ?? ?? }
        $dll1 = "mscoree"
        $dll2 = "mscorlib"
        $PE_magic_byte = "MZ"

    condition:
        // Fill out the conditions that must be met to identify the binary
        $PE_magic_byte at 0 and
        ($embed_files_bytecode and $embed_reg_key_bytecode and $dll1 or $dll2) or
        ($namespace and $dll1 or $dll2)
}